!function(e){var t={};function a(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,a),o.l=!0,o.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=7)}([function(e,t,a){"use strict";var n={map:null,circle:null,gmarkers:[],latlng:{},geocoder:new google.maps.Geocoder,service:null,places:{},fromMarker:null,directionsService:null,directionsDisplay:null,searchRadius:0,slickInitialized:!1,hotelsSearch:!1,outsideSearch:!1,locationRadius:0};t.a=n},function(e,t,a){"use strict";var n=a(0),o=a(2),r=a(3),l=a(5),s={lastPinLocation:null,create(e,t="",a=!1){var s,i=this,c=null;e.registered&&(c="http://maps.google.com/mapfiles/ms/icons/green-dot.png"),a&&(c="../img/draged.svg"),s=a&&o.a.validator.isEmpty(!i.lastPinLocation)?i.lastPinLocation:{lat:e.lat,lng:e.lng};var d=new google.maps.Marker({position:s,map:n.a.map,icon:c,draggable:a});(e.popup_info&&i.addInfoWindowForMarker(d,e),e.id&&d.addListener("click",function(){l.a.getGoogleDataById(e.id)}),""!=t)&&new google.maps.InfoWindow({content:t}).open(n.a.map,d);a&&d.addListener("dragend",function(e){i.lastPinLocation={lat:e.latLng.lat(),lng:e.latLng.lng()},r.a.init(e.latLng.lat(),e.latLng.lng(),!0,null,n.a.map.getZoom())}),d.setAnimation(google.maps.Animation.DROP),n.a.gmarkers.push(d)},addInfoWindowForMarker(e,t){var a=new google.maps.InfoWindow;a.setContent("<div><strong>"+t.name+"</strong><br>"),e.addListener("mouseover",function(){a.open(n.a.map,this)}),e.addListener("mouseout",function(){a.close()})},setMapOnAll(e){for(var t=0;t<n.a.gmarkers.length;t++)n.a.gmarkers[t].setMap(e)},clear(){this.setMapOnAll(null),n.a.gmarkers.length=0}};t.a=s},function(e,t,a){"use strict";var n={validator:{isEmpty:e=>!e||isNaN(e)||""==e||0==e,isUndef:e=>void 0===e},linkClassRemover(e){for(var t=document.getElementById(e).querySelectorAll("a"),a=0;a<t.length;a++)t[a].classList.remove("active")},updateWeather(e){$(".weather").html('<iframe sandbox="allow-scripts allow-same-origin" id="forecast_embed" type="text/html" frameborder="0" src="//forecast.io/embed/#lat='+e.lat+"&lon="+e.lng+"&name=Weather for "+document.getElementById("map_b").getAttribute("data-city")+'"> </iframe>')},goScroll(e){var t=e;$("html, body").stop().animate({scrollTop:$(t.getAttribute("href")).offset().top},1500)}};t.a=n},function(e,t,a){"use strict";var n=a(0),o=a(4),r=a(1),l={init(e=0,t=0,a=!1,l,s=null){var i=$("#map_b").data("slug"),c=$("#map_b").data("displayhotels"),d=document.getElementById("map_b");s||(s="Boston"===d.getAttribute("data-city")?2:14),n.a.locationRadius=$("#map_b").data("locationradius"),"hotels"==i&&(n.a.hotelsSearch=!0,2==c&&(n.a.outsideSearch=!0)),n.a.latlng=0==e&&0==t?{lat:parseFloat(d.getAttribute("data-lat")),lng:parseFloat(d.getAttribute("data-lng"))}:{lat:e,lng:t},n.a.fromMarker=n.a.latlng,n.a.map=new google.maps.Map(d,{zoom:s,center:n.a.latlng,disableDefaultUI:!0,fullscreenControl:!1,gestureHandling:"greedy"}),n.a.service=new google.maps.places.PlacesService(n.a.map),n.a.directionsService=new google.maps.DirectionsService,n.a.directionsDisplay=new google.maps.DirectionsRenderer({suppressMarkers:!0}),n.a.directionsDisplay.setMap(n.a.map);var m=document.createElement("div");m.classList.add("map-control");new MakeControl(m,n.a.map,!0);m.index=1,n.a.map.controls[google.maps.ControlPosition.BOTTOM_CENTER].push(m),n.a.fromMarker.lat===parseFloat(d.getAttribute("data-lat"))&&n.a.fromMarker.lng===parseFloat(d.getAttribute("data-lng"))?o.a.get(n.a.latlng,function(){r.a.create(n.a.fromMarker,l||d.getAttribute("data-city"),a)}):(document.getElementById("app-nav").innerHTML="",o.a.get(n.a.fromMarker,function(e){r.a.create(n.a.fromMarker,l||e,a)}))}};t.a=l},function(e,t,a){"use strict";var n=a(0),o={get(e,t){n.a.geocoder.geocode({latLng:e},function(a){a[0].formatted_address&&(e.lat===parseFloat(DEFAULT_POINT.lat)&&e.lng===parseFloat(DEFAULT_POINT.lng)?(t(DEFAULT_POINT.address),document.getElementById("adressInput").value=DEFAULT_POINT.address):(t(a[0].formatted_address),document.getElementById("adressInput").value=a[0].formatted_address))})},getCityName(e){var t=e.lat,a=e.lng;$.ajax({type:"GET",dataType:"json",url:"https://maps.googleapis.com/maps/api/geocode/json?latlng="+t+","+a+"&sensor=false",data:{},error:function(){console.log("error")}})}};t.a=o},function(e,t,a){"use strict";var n=a(0),o=a(2),r=a(6),l=a(1),s={getGoogleDataById(e,t){$("#location_info").slideDown("fast"),o.a.linkClassRemover("app-nav"),o.a.linkClassRemover("detail-nav"),t&&t.classList.add("active");var a=!1;t&&t.classList.contains("referral-available")&&(a=!0),$("#"+e).addClass("active"),document.getElementById("infotab").classList.add("active");var l=this,s={placeId:e};n.a.service.getDetails(s,function(e,t){t==google.maps.places.PlacesServiceStatus.OK&&(l.setInfo(e,a),r.a.makeRoute(e))})},setInfo(e,t=!1){(e.address_components.length>6?$("#place_address").html(e.address_components[0].short_name+" "+e.address_components[1].short_name+", "+e.address_components[2].short_name+"<br>"+e.address_components[4].short_name+" "+e.address_components[6].short_name+"<br>"+e.address_components[5].short_name):$("#place_address").html(e.address_components[0].long_name+" "+e.address_components[1].long_name+", "+e.address_components[2].long_name),$("#place_name").html(e.name),t)&&($("#place_name").append('<br><button id="referral_complete_btn" data-place="'+e.place_id+'" data-name="'+e.name+'" data-location="'+e.geometry.location.lat()+" "+e.geometry.location.lng()+'">Complete Referral</button>'),document.getElementById("referral_complete_btn").addEventListener("click",function(e){$(".referral_form").length||(e.preventDefault(),$("#place_address").prepend($(".referral_form_example").clone().addClass("referral_form").show()))}));$("#placeMapName").html(e.name),$("#place_phone").html(e.formatted_phone_number),e.website?($("#place_site").show(),$("#place_site").html(e.website)):$("#place_site").hide(),$("#place_site").attr("href",e.website),$("#sitetab").attr("target","_blank"),$("#sitetab").attr("href",e.website),$("#place_types").html(e.types.join(", "));var a="";e.photos&&$.each(e.photos,function(e,t){var n=t.getUrl({maxWidth:635,maxHeight:470});a+='<div class="item" ><div class="img" style="background-image: url('+n+')"></div></div>'}),$("#place_photos").html(a);var n="";e.reviews&&$.each(e.reviews,function(e,t){n+='<li><div class="place_review">',n+="<b>overall Rating:</b> "+t.rating+"/5 <br>",n+="<b>Author:</b> "+t.author_name+"<br>",n+="<p>"+t.text+"</p>",n+="<hr/>",n+="</div></li>"}),$("#place_reviews").html(n),$("#location_info").show()},clearInfo(){$("#place_name").html(""),$("#placeMapName").html(""),$("#place_phone").html(""),$("#place_site").html(""),$("#place_site").attr(""),$("#sitetab").attr(""),$("#sitetab").attr(""),$("#place_types").html(""),$("#location_info").hide()},showInfoBlock(){$("#directions_info").hide(),$("#location_info").show()},showDirectionBlock(){$("#location_info").hide(),$("#directions_info").show()},addPlacesToMap(e,t=""){for(var a in l.a.clear(),"useMapForMarker"===t?l.a.create(e,document.getElementById("map_b").getAttribute("data-city"),!0):l.a.create(e,document.getElementById("map_b").getAttribute("data-city")),n.a.places){e=n.a.places[a];this.makeSideBarItm(e,t),l.a.create(e)}},makeSideBarItm(e,t=""){var a=e.lat+"&"+e.lng,n=e.name,o=this,r=document.createElement("li"),l=document.createElement("a");l.setAttribute("href",a),1==e.registered?l.setAttribute("class","registered-item"):1!=e.registered&&"referralMode"==t&&l.setAttribute("class","referral-available"),l.addEventListener("click",t=>{t.preventDefault(),o.getGoogleDataById(e.id,t.target)}),l.setAttribute("id",e.id),l.innerText=n,r.appendChild(l),document.getElementById("app-nav").appendChild(r)}};t.a=s},function(e,t,a){"use strict";var n=a(1),o=a(0),r={makeRoute(e){n.a.clear();var t=this,a={},r="DRIVING",l=document.getElementById("fromHotelPosition");o.a.searchRadius<=2&&(r="WALKING"),a=l&&l.classList.contains("active")?{lat:parseFloat(LOCATION_POINT.lat),lng:parseFloat(LOCATION_POINT.lng)}:{lat:parseFloat(document.getElementById("map_b").getAttribute("data-lat")),lng:parseFloat(document.getElementById("map_b").getAttribute("data-lng"))},o.a.directionsService.route({origin:a,destination:e.geometry.location,travelMode:r},function(r,l){"OK"===l?(o.a.directionsDisplay.setDirections(r),LOCATION_POINT.lat&&parseFloat(LOCATION_POINT.lat)===a.lat&&a.lng===parseFloat(LOCATION_POINT.lng)?n.a.create(a,LOCATION_POINT.name):n.a.create(a,"Start Location"),n.a.create({lat:e.geometry.location.lat(),lng:e.geometry.location.lng()},e.name),t.flushDirections(),t.getAllDirections(a,e.geometry.location)):window.alert("Directions request failed due to "+l)})},getAllDirections(e,t){var a=this;$.each(["WALKING","DRIVING","BICYCLING","TRANSIT"],function(n,r){o.a.directionsService.route({origin:e,destination:t,travelMode:r},function(e,t){"OK"===t?(o.a.directionsDisplay.setDirections(e),a.showDirections(e,r)):console.log("Directions request failed due to "+t)})})},flushDirections(){$("#directions_driving").html(""),$("#directions_transit").html(""),$("#directions_bicycling").html(""),$("#directions_walking").html("")},showDirections(e,t="WALKING"){for(var a=e.routes[0].legs[0],n=0;n<a.steps.length;n++)$("#directions_"+t.toLowerCase()).append("<p>"+a.steps[n].instructions+" "+a.steps[n].distance.text+"</p>")}};t.a=r},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),o=a(1),r=(a(6),a(0)),l=a(3),s=a(5),i=a(4),c={method:"",resultType:$("input[name=type]:checked").val(),getJson(e,t,a){r.a.searchRadius=a,r.a.places={};var o=new XMLHttpRequest,l=a,i="start=0&length=0&latitude="+e+"&longitude="+t+"&radius="+1.609*l+"&location_type=-1&tag="+this.getResultType()+"&disabled=0";o.open("POST","/get_locations/false",!1),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send(i),this.saveSearchPosition(e,t);var d=this;if(200!==o.status)return console.log(o.status+": "+o.statusText),!1;var m=JSON.parse(o.responseText);if(document.getElementById("app-nav").innerHTML="",m.recordsFiltered>0)for(var u in m.data){var p=m.data[u].lat,g=m.data[u].lng;r.a.places[u]={id:u,lat:p,lng:g,name:m.data[u].name,registered:!0,popup_info:m.data[u].name}}var f={location:{lat:e,lng:t},radius:l*parseInt(document.querySelector('#distanceSI input[type="radio"]:checked').value),type:this.getResultType()};r.a.service.nearbySearch(f,function(e,t){if(t!=google.maps.places.PlacesServiceStatus.OK)return document.getElementById("app-nav").innerHTML="No "+d.getResultType()+" listings found",!1;for(var a=0;a<e.length;a++){var o=e[a];r.a.places[o.place_id]||(r.a.places[o.place_id]={id:o.place_id,lat:o.geometry.location.lat(),lng:o.geometry.location.lng(),name:o.name,registered:!1,popup_info:o.name})}r.a.outsideSearch?r.a.locationRadius>l?r.a.places={}:(f.radius=r.a.locationRadius*parseInt(document.querySelector('#distanceSI input[type="radio"]:checked').value),r.a.service.nearbySearch(f,function(e,t){if(t!=google.maps.places.PlacesServiceStatus.OK)return!1;for(var a=0;a<e.length;a++){var o=e[a];r.a.places[o.place_id]&&delete r.a.places[o.place_id]}s.a.addPlacesToMap(f.location,c.method),n.a.updateWeather(f.location)})):(s.a.addPlacesToMap(f.location,c.method),n.a.updateWeather(f.location))})},saveSearchPosition(e,t){var a=document.getElementById("adressInput").value,n=document.getElementById("distanceInput").value,o=document.getElementById("location_id").value,r=document.getElementById("map_b"),l=document.getElementById("fromHotelPosition");l&&l.classList.contains("active")||$.ajax({method:"POST",url:"/save_search_position",data:{lat:e,lng:t,city:a,distance:n,location_id:o}}).done(function(n){r.setAttribute("data-lat",e),r.setAttribute("data-lng",t),r.setAttribute("data-city",a),r.setAttribute("data-locationId",o)})},getResultType(){return r.a.hotelsSearch?"lodging":this.resultType},changeHandler(){this.resultType=$("input[name=type]:checked").val()},disableAdressInput(){document.getElementById("search-form").classList.remove("active-adress")},reloadResults(){document.getElementById("app-nav").innerHTML="",s.a.clearInfo()},fromHotelPosition(){this.method="fromHotelPosition",this.reloadResults(),l.a.init(parseFloat(LOCATION_POINT.lat),parseFloat(LOCATION_POINT.lng),!1,LOCATION_POINT.name)},useAdress:function(){this.method="useAdress",document.getElementById("search-form").classList.add("active-adress"),this.reloadResults(),LOCATION_POINT.lat===document.getElementById("map_b").getAttribute("data-lat")&&LOCATION_POINT.lng===document.getElementById("map_b").getAttribute("data-lng")?l.a.init(parseFloat(DEFAULT_POINT.lat),parseFloat(DEFAULT_POINT.lng)):l.a.init()},referralMode:function(){this.method="referralMode",document.getElementById("search-form").classList.add("active-adress"),this.reloadResults(),PNotify.notice({title:"Select and add referrals",text:"Find them on map and click button 'Complete Referral'"}),LOCATION_POINT.lat===document.getElementById("map_b").getAttribute("data-lat")&&LOCATION_POINT.lng===document.getElementById("map_b").getAttribute("data-lng")?l.a.init(parseFloat(DEFAULT_POINT.lat),parseFloat(DEFAULT_POINT.lng)):l.a.init()},getCurrentPosition(){this.method="getCurrentPosition",this.reloadResults(),navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{l.a.init(e.coords.latitude,e.coords.longitude),i.a.getCityName({lat:e.coords.latitude,lng:e.coords.longitude}),c.codeAdress(e.coords.latitude,e.coords.longitude,parseInt(distanceInput.value)),setTimeout(n.a.updateWeather({lat:e.coords.latitude,lng:e.coords.longitude}),2e3)},e=>{console.warn(e.code+": "+e.message)}):console.log("Geolocation is not supported by this browser.")},useMapForMarker(){this.method="useMapForMarker",this.reloadResults(),l.a.init(r.a.fromMarker.lat,r.a.fromMarker.lng,!0,"Dropped Pin Start Point",r.a.map.getZoom()),c.codeAdress(r.a.fromMarker.lat,r.a.fromMarker.lng,parseInt(distanceInput.value))},codeAdress(e,t,a){var n,l=this,s=document.getElementById("search-form"),i=document.getElementById("adressInput"),c=(e||r.a.latlng.lat,t||r.a.latlng.lng,a||2);n=s.classList.contains("active-adress")&&""!==i.value?{address:i.value}:{location:{lat:r.a.latlng.lat,lng:r.a.latlng.lng}},r.a.geocoder.geocode(n,function(e,t){if(t==google.maps.GeocoderStatus.OK){var a=e[0].geometry.location;o.a.clear(),l.getJson(a.lat(),a.lng(),c),r.a.circle&&r.a.circle.setMap(null),r.a.circle=new google.maps.Circle({center:a,radius:c*parseInt(document.querySelector('#distanceSI input[type="radio"]:checked').value),strokeColor:"#9f2d2d",strokeWeight:2,fillOpacity:0,zoom:2,map:r.a.map}),r.a.map.fitBounds(r.a.circle.getBounds())}else console.log("Geocode was not successful for the following reason: "+t)})},sendReferralRequest:function(e){$.ajax({method:"POST",crossOrigin:!0,xhrFields:{withCredentials:!0},crossDomain:!0,url:"//hotelareaguide.com/create-referral",data:e}).done(function(e){e.success?PNotify.success({title:"Success",text:e.message}):PNotify.error({title:"Error",text:e.message}),console.log(e)})}};document.addEventListener("DOMContentLoaded",function(e){if(document.getElementById("map-app")){c.changeHandler(),$(".anc.active").trigger("click"),""!==LOCATION_POINT?l.a.init(parseFloat(LOCATION_POINT.lat),parseFloat(LOCATION_POINT.lng),!1,LOCATION_POINT.name):l.a.init();var t=document.getElementById("search-form"),a=document.getElementById("detail-nav"),o=document.getElementById("distanceInput"),r=document.querySelectorAll("#typeOfResult input[type=radio]");c.codeAdress(null,null,parseInt(distanceInput.value)),t.addEventListener("submit",function(e){e.preventDefault(),n.a.linkClassRemover("detail-nav"),document.getElementById("maptab").classList.add("active"),document.getElementById("location_info").classList.add("hidden"),c.codeAdress(null,null,parseInt(distanceInput.value))}),a.addEventListener("click",function(e){var t=e.target.closest("a");document.querySelector("#app-nav a.active")?t&&"sitetab"!==t.id&&(e.preventDefault(),n.a.linkClassRemover("detail-nav"),t.classList.add("active"),s.a[t.getAttribute("data-action")](),n.a.goScroll(t)):e.preventDefault()});for(var i=0;i<r.length;i++)r[i].addEventListener("change",function(){c.changeHandler()});document.getElementById("distance-wrp").addEventListener("click",function(e){!function(e,t){if("SPAN"!==e.target.nodeName)return;"dec"===e.target.id&&t.value>0?t.value=parseInt(t.value)-1:"inc"===e.target.id&&(t.value=parseInt(t.value)+1)}(e,o)})}$(document).ready(function(){$("#app-nav a").click(function(){$("#app-nav a").removeClass("active"),$(this).addClass("active")}),$("#sfw-btn").click(function(){$("#full-screen-wrp").toggleClass("shw")}),$(".anc").click(function(){var e=$(this).attr("id");return $(".anc").removeClass("active"),$(this).addClass("active"),"useAdress"===e&&"referralMode"===e||c.disableAdressInput(),c[e](),!1}),$(document).on("click",".referral_form .submit_btn",function(){var e={place_id:$("#referral_complete_btn").data("place"),name:$(".referral_form .name_inp").val(),phone:$(".referral_form .phone_inp").val(),ref_email:$(".referral_form .email_ref_inp").val(),place_name:$("#referral_complete_btn").data("name"),location:$("#referral_complete_btn").data("location")};if(""==e.name||""==e.phone||""==e.ref_email)return PNotify.error({title:"Error",text:"Fill all referral fields"}),!1;c.sendReferralRequest(e)})})})}]);